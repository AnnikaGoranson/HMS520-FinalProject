library("data.table")
library("dplyr")
library("ggpubr")
library("ggplot2")

View(`2021toxinsdata`)

# Analysis 
# Function to create a ggplot2 bar graph
create_bar_graph <- function(data, x, x_title, y, y_title, main_title, strata, strata_labs, theme) {
  # Create the bar graph
  ggplot(data, aes(x = x, y = y)) +
    geom_bar(stat = "identity", fill = "dark green") +
    facet_wrap(~strata, labeller = labeller(strata = strata_labs)) +
    xlab(x_title) +
    ylab(y_title) +
    ggtitle(main_title) +
    theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 5)
}

# Function to create a ggplot2 scatter plot
create_scatter_plot <- function(data, x, x_title, y, y_title, main_title, strata, strata_labs,  theme) {
  # Create the scatter plot
  ggplot(data, aes(x = x, y = y)) +
    geom_point() +
    facet_wrap(~strata, strata = strata_labs) +
    xlab(x_title) +
    ylab(y_title) +
    ggtitle(main_title) +
    theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 5))
}

# Stratified by carcinogen 
carcinogen_labs <- c("Non-carcinogen", "Carcinogen")
names(carcinogen_labs) <- c(0, 1)

create_bar_graph(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by Carcinogen Status", carcinogen, carcinogen_labs, theme_bw())
create_scatter_plot(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by Carcinogen Status", carcinogen, carcinogen_labs, theme_bw())

# Stratified by metal
metal_labs <- c("Non-metal", "Metal")
names(metal_labs) <- c(0, 1)

create_bar_graph(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by Metal Status", metal, metal_labs, theme_bw())
create_scatter_plot(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by Metal Status", metal, metal_labs, theme_bw())

# Stratified by pbt
pbt_labs <- c("Non-PBT", "PBT")
names(pbt_labs) <- c(0, 1)

create_bar_graph(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by PBT Status", pbt, pbt_labs, theme_bw())
create_scatter_plot(`2021toxinsdata`, state, "State", production.ratio, "Production Ratio", "Production Ratio by State by PBT Status", pbt, pbt_labs, theme_bw())
